//--------------------------------------
// This file is autogenerated by grackle
// DO NOT MANUALLY EDIT THIS FILE
//--------------------------------------

package calendar_gk

import (
	"github.com/goose-lang/std"
	"github.com/tchajed/marshal"

	"github.com/mjschwenne/grackle/testdata/out/go/event_gk"
)

type S struct {
	Hash   []byte
	Events []event_gk.S
}

func Marshal(enc []byte, c S) []byte {
	enc = marshal.WriteInt(enc, uint64(len(c.Hash)))
	enc = marshal.WriteBytes(enc, c.Hash)

	enc = marshal.WriteInt(enc, uint64(len(c.Events)))
	enc = marshal.WriteSlice[event_gk.S](enc, c.Events, event_gk.Marshal)

	return enc
}

func Unmarshal(s []byte) (S, []byte) {

	hashBytes, s := marshal.ReadLenPrefixedBytes(s)
	hash := std.BytesClone(hashBytes)
	eventsLen, s := marshal.ReadInt(s)
	events, s := marshal.ReadSlice[event_gk.S](s, eventsLen, event_gk.Unmarshal)

	return S{
		Hash:   hash,
		Events: events,
	}, s
}
